<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="one.database.mapper.FriendsInterface">

	<select id="getTeamList" parameterType="one.services.beans.TeamBean" resultType="one.services.beans.TeamBean">
		SELECT * FROM TEAMLISTVIEW WHERE MSID= #{msId}
	</select>

	<select id="getMemberList" parameterType="one.services.beans.TDetailBean" resultType="one.services.beans.TDetailBean">
		SELECT * FROM MEMBERLISTVIEW WHERE TCODE= #{tCode}
	</select>

	<!-- 오늘날짜의 몇개의팀이 만들어졌는지 확인하는 메서드 -->
	<select id="getCount" resultType="int">
		SELECT
		MAX(TO_NUMBER(SUBSTR(T_CODE,7,3))) FROM T WHERE SUBSTR(T_CODE,1,6) =
		TO_CHAR(SYSDATE,'YYMMDD')
	</select>

	<!-- 팀 추가 -->
	<insert id="insTeam" parameterType="one.services.beans.TeamBean">
		INSERT INTO T
		VALUES(TO_CHAR(SYSDATE,'YYMMDD') || #{tCodeNum} , #{tName})
	</insert>

	<select id="getNewCode" resultType="string">
		SELECT MAX(T_CODE) FROM T
		WHERE SUBSTR(T_CODE,1,6) =
		TO_CHAR(SYSDATE,'YYMMDD')
	</select>

	<insert id="insMb" parameterType="one.services.beans.TeamBean">
		INSERT INTO TD VALUES
		(#{tCode}, #{msId},'L')
	</insert>

	<!-- 내가 맺은 친구들 select -->
	<select id="getFriends" parameterType="one.services.beans.TDetailBean" resultType="one.services.beans.TDetailBean">
	
	SELECT MSID , MSNAME
	FROM REQUESTFRIEND
	WHERE FRID=#{msId} AND FR_ACCEPT='1'
	UNION 
	SELECT FRID,MSNAME
	FROM RECEIVERFRIEND 
	WHERE MSID=#{msId}  AND FR_ACCEPT='1'
	</select>

</mapper>